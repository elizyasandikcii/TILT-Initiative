<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TILT - The Initiative for Life and Thoughts</title>
    <!-- Chart.js for stock charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="icon" href="https://cdn.glitch.global/5f72f9b5-5a11-4f80-b63f-8b4fc4574362/logoka%C5%9Fe%20(2).png?v=1745342288049" type="image/png">
    <style>
        :root {
            --primary-color: #000033;
            --secondary-color: #f8f9fa;
            --accent-color: #003366;
            --text-color: #333;
            --light-text: #f8f9fa;
            --transition-speed: 0.3s;
            --header-height: 90px;
            --header-shrink-height: 60px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            line-height: 1.6;
            transition: background-color var(--transition-speed);
            padding-top: var(--header-height);
            background-color: white; /* Default light mode */
        }

        .dark-mode {
            background-color: #121212;
            color: #f0f0f0;
            --text-color: #f0f0f0;
            --secondary-color: #1e1e1e;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: var(--secondary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: var(--header-height);
            transition: all 0.4s ease;
        }

        header.shrink {
            height: var(--header-shrink-height);
            padding: 0.5rem 2rem;
        }

        header.shrink .logo {
            height: 40px;
            width: 120px;
        }

        header.shrink nav a {
            font-size: 0.9rem;
        }

        .logo {
            width: 150px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s ease;
        }

        .logo img {
            max-height: 100%;
            max-width: 100%;
            object-fit: contain;
        }

        nav ul {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        nav li {
            margin: 0 1rem;
            position: relative;
        }

        nav a {
            text-decoration: none;
            color: var(--text-color);
            font-weight: 500;
            padding: 0.5rem 0;
            position: relative;
            transition: all var(--transition-speed);
            font-size: 1rem;
        }

        nav a:hover {
            color: var(--accent-color);
        }

        nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: var(--accent-color);
            transition: width var(--transition-speed) ease;
        }

        nav a:hover::after {
            width: 100%;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .language-selector {
            position: relative;
        }

        .language-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-weight: 500;
            padding: 0.5rem;
        }

        .language-menu {
            position: absolute;
            right: 0;
            top: 100%;
            background-color: var(--secondary-color);
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            padding: 0.5rem 0;
            min-width: 120px;
            display: none;
            z-index: 100;
        }

        .language-menu a {
            display: block;
            padding: 0.5rem 1rem;
            color: var(--text-color);
            text-decoration: none;
            transition: background-color var(--transition-speed);
        }

        .language-menu a:hover {
            background-color: rgba(0, 51, 102, 0.1);
        }

        .language-selector:hover .language-menu {
            display: block;
        }

        .theme-switch {
            display: flex;
            align-items: center;
            position: relative;
            width: 44px;
            height: 44px;
        }

        .theme-toggle {
            appearance: none;
            -webkit-appearance: none;
            position: absolute;
            width: 100%;
            height: 100%;
            margin: 0;
            cursor: pointer;
            z-index: 2;
            opacity: 0;
        }

        .theme-icon {
            position: absolute;
            width: 24px;
            height: 24px;
            top: 10px;
            left: 10px;
            transition: all 0.4s ease;
            transform-origin: center;
        }

        .sun {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }

        .dark-mode .sun {
            opacity: 0;
            transform: scale(0.5) rotate(90deg);
        }

        .moon {
            opacity: 0;
            transform: scale(0.5) rotate(-90deg);
        }

        .dark-mode .moon {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }

        .sun-icon, .moon-icon {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .sun-icon {
            background: radial-gradient(circle, currentColor 30%, transparent 30%);
            box-shadow: 0 0 0 2px currentColor;
            border-radius: 50%;
        }

        .sun-icon::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            width: 2px;
            height: 8px;
            background: currentColor;
            transform: translateX(-50%);
        }

        .sun-icon::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            width: 2px;
            height: 8px;
            background: currentColor;
            transform: translateX(-50%);
        }

        .moon-icon {
            border-radius: 50%;
            box-shadow: -6px 0 0 2px currentColor;
        }

        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .content-columns {
            display: flex;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .content-column {
            flex: 1;
        }

        section {
            margin-bottom: 2rem;
        }

        h1, h2, h3 {
            color: var(--accent-color);
        }

        .upcoming-episodes {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            height: 100%;
        }

        .upcoming-episodes h2 {
            margin-top: 0;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
        }

        .placeholder-image {
            height: 200px;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1rem 0;
            border-radius: 4px;
            color: #6c757d;
        }

        .learn-more {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 500;
            display: inline-block;
            margin-top: 1rem;
            transition: transform 0.2s;
        }

        .learn-more:hover {
            text-decoration: underline;
            transform: translateX(5px);
        }

        .newsflash {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            height: 100%;
        }

        .newsflash h2 {
            margin-top: 0;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
        }

        .newsflash blockquote {
            border-left: 4px solid var(--accent-color);
            padding-left: 1rem;
            margin: 1.5rem 0;
            font-style: italic;
        }

        .update-info {
            font-size: 0.9rem;
            color: #6c757d;
            text-align: right;
            margin-top: 2rem;
        }

        /* Calendar Styles */
        .calendar-container {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-header h2 {
            margin: 0;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calendar-nav {
            display: flex;
            gap: 0.5rem;
        }

        .calendar-nav button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .calendar-nav button:hover {
            background-color: var(--primary-color);
        }

        .calendar {
            width: 100%;
            border-collapse: collapse;
        }

        .calendar th {
            padding: 0.75rem;
            text-align: center;
            background-color: var(--accent-color);
            color: white;
        }

        .calendar td {
            padding: 0.75rem;
            text-align: center;
            border: 1px solid #ddd;
            position: relative;
            height: 40px;
            width: 40px;
        }

        .calendar td:hover {
            background-color: rgba(0, 51, 102, 0.1);
        }

        .current-day {
            background-color: #007bff;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }

        .other-month {
            color: #ccc;
        }

        .event-indicator {
            height: 6px;
            width: 6px;
            background-color: #dc3545;
            border-radius: 50%;
            margin: 2px auto;
            cursor: pointer;
        }

        .event-day {
            background-color: rgba(220, 53, 69, 0.1);
        }

        /* News Section Styles */
        .news-section {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .news-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .news-header h2 {
            margin: 0;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nyt-logo {
            height: 30px;
            vertical-align: middle;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .news-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .news-card:hover {
            transform: translateY(-5px);
        }

        .news-image {
            width: 100%;
            height: 160px;
            object-fit: cover;
        }

        .news-content {
            padding: 1.2rem;
        }

        .news-title {
            font-size: 1.1rem;
            margin: 0 0 0.8rem 0;
            line-height: 1.4;
            height: 3em;
            overflow: hidden;
        }

        .news-title a {
            color: var(--accent-color);
            text-decoration: none;
        }

        .news-title a:hover {
            text-decoration: underline;
        }

        .news-description {
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 1rem;
            line-height: 1.5;
            height: 4em;
            overflow: hidden;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #777;
        }

        .news-section .loading {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }

        .news-section .error {
            text-align: center;
            padding: 2rem;
            color: #dc3545;
        }

        .refresh-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }

        .refresh-btn:hover {
            background-color: var(--primary-color);
        }

        footer {
            background-color: var(--secondary-color);
            padding: 2rem;
            text-align: center;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            :root {
                --header-height: 140px;
                --header-shrink-height: 100px;
            }
            
            header {
                flex-direction: column;
                padding: 1rem;
                height: var(--header-height);
            }

            header.shrink {
                height: var(--header-shrink-height);
            }

            nav ul {
                flex-wrap: wrap;
                justify-content: center;
                margin-top: 1rem;
            }

            nav li {
                margin: 0.5rem;
            }

            .header-controls {
                margin-top: 1rem;
            }
            
            .content-columns {
                flex-direction: column;
            }

            .news-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Stock Market Section Styles */
        .stocks-section {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .stocks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .stocks-header h2 {
            margin: 0;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stock-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .stock-select {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
        }

        .timeframe-select {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
        }

        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }

        .stock-info {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            padding: 1rem;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .stock-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .stock-change {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
        }

        .positive {
            color: #28a745;
        }

        .negative {
            color: #dc3545;
        }

        .stocks-section .loading {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }

        .stocks-section .error {
            text-align: center;
            padding: 2rem;
            color: #dc3545;
        }

        @media (max-width: 768px) {
            .stock-controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .chart-container {
                height: 300px;
            }
        }
        
        /* Currency Exchange Section Styles */
        .currency-section {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .currency-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .currency-header h2 {
            margin: 0;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .currency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .currency-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            padding: 1.5rem;
        }

        .currency-card:hover {
            transform: translateY(-5px);
        }

        .currency-pair {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .currency-flag {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
        }

        .currency-rate {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0.5rem 0;
            text-align: center;
        }

        .currency-change {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .currency-info {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            font-size: 0.8rem;
            color: #777;
        }

        .currency-section .loading {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }

        .currency-section .error {
            text-align: center;
            padding: 2rem;
            color: #dc3545;
        }

        @media (max-width: 768px) {
            .currency-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Map and Clocks Section Styles */
        .map-clocks-section {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            height: 500px;
        }

        .map-container {
            flex: 1;
            min-width: 300px;
            height: 100%;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .clocks-container {
            flex: 1;
            min-width: 300px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            height: 100%;
        }

        .clock-card {
            background-color: var(--secondary-color);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .clock-city {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        .clock-time {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .clock-date {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .clock-flag {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        /* Dark mode adjustments */
        .dark-mode .clock-card {
            background-color: #1e1e1e;
            color: #f0f0f0;
        }

        .dark-mode .clock-date {
            color: #cccccc;
        }

        .dark-mode .upcoming-episodes,
        .dark-mode .newsflash,
        .dark-mode .calendar-container,
        .dark-mode .news-section,
        .dark-mode .stocks-section,
        .dark-mode .currency-section {
            background-color: #1e1e1e;
            color: #f0f0f0;
        }

        .dark-mode .news-card,
        .dark-mode .stock-info,
        .dark-mode .currency-card {
            background-color: #2d2d2d;
            color: #f0f0f0;
        }

        .dark-mode .news-description,
        .dark-mode .news-meta,
        .dark-mode .currency-info {
            color: #cccccc;
        }

        .dark-mode .calendar td {
            border-color: #444;
        }

        .dark-mode .stock-select,
        .dark-mode .timeframe-select {
            background-color: #2d2d2d;
            color: #f0f0f0;
            border-color: #555;
        }

        @media (max-width: 768px) {
            .map-clocks-section {
                flex-direction: column;
                height: auto;
            }
            
            .map-container, .clocks-container {
                width: 100%;
                height: 300px;
            }
            
            .clocks-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header id="main-header">
        <div class="logo">
            <img src="https://cdn.glitch.global/5f72f9b5-5a11-4f80-b63f-8b4fc4574362/logoka%C5%9Fe%20(2).png?v=1745342288049" alt="TILT Logo" class="logo-image">
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="projects.html">Projects</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="contact-us.html">Contact Us</a></li>
                <li><a href="get-involved.html">Get Involved</a></li>
            </ul>
        </nav>
        <div class="header-controls">
            <div class="language-selector">
                <button class="language-btn">EN</button>
                <div class="language-menu">
                    <a href="index.html">ðŸ‡¬ðŸ‡§English</a>
                    <a href="tr-index.html">ðŸ‡¹ðŸ‡·TÃ¼rkÃ§e</a>
                </div>
            </div>
            <div class="theme-switch">
                <input type="checkbox" id="theme-toggle" class="theme-toggle">
                <div class="theme-icon sun">
                    <div class="sun-icon"></div>
                </div>
                <div class="theme-icon moon">
                    <div class="moon-icon"></div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="content-columns">
            <div class="content-column">
                <section class="upcoming-episodes">
                    <h2>TILT - The Initiative for Life and Thoughts</h2>
                    <p>Exploring the intersection of philosophy, science, and everyday life to foster deeper understanding and meaningful change.</p>
                    
                    <div class="placeholder-image">
                        [Placeholder for TILT promotional image or graphic]
                    </div>
                    
                    <p>The Initiative for Life and Thoughts (TILT) is dedicated to creating spaces for reflection, dialogue, and action on the most pressing questions of our time. We bring together thinkers, creators, and activists to challenge assumptions and explore new possibilities.</p>
                    <a href="about.html" class="learn-more">Learn more...</a>
                </section>
            </div>
            
            <div class="content-column">
                <section class="newsflash">
                    <h2>LATEST BLOG</h2>
                    <blockquote>
                        "The unexamined life is not worth living." - Socrates
                    </blockquote>
                    <h3>Rethinking Our Relationship With Technology</h3>
                    <p>In our latest blog post, we explore how digital technologies are reshaping human cognition and relationships, and what we can do to maintain our humanity in an increasingly algorithmic world...</p>
                    <a href="blog.html" class="learn-more">Read more...</a>
                    
                    <div class="update-info">
                       By: Elizya 
                        LATEST UPDATE - 25 DAY(S)
                    </div>
                </section>
            </div>
        </div>
        
        <!-- News Section -->
        <section class="news-section">
            <div class="news-header">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"></path>
                        <path d="M18 14h-8"></path>
                        <path d="M15 18h-5"></path>
                        <path d="M10 6h8v4h-8V6Z"></path>
                    </svg>
                    Latest News from New York Times
                </h2>
                <button class="refresh-btn" id="refresh-news">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 0 1 9-9"></path>
                    </svg>
                    Refresh
                </button>
            </div>
            <div class="news-grid" id="news-container">
                <div class="loading">Loading news...</div>
            </div>
        </section>
        
        <!-- Calendar Section -->
        <section class="calendar-container">
            <div class="calendar-header">
                <h2 id="calendar-month-year">Month Year</h2>
                <div class="calendar-nav">
                    <button id="prev-month">&lt; Prev</button>
                    <button id="today">Today</button>
                    <button id="next-month">Next &gt;</button>
                </div>
            </div>
            <table class="calendar">
                <thead>
                    <tr>
                        <th>Sun</th>
                        <th>Mon</th>
                        <th>Tue</th>
                        <th>Wed</th>
                        <th>Thu</th>
                        <th>Fri</th>
                        <th>Sat</th>
                    </tr>
                </thead>
                <tbody id="calendar-body">
                    <!-- Calendar will be generated by JavaScript -->
                </tbody>
            </table>
        </section>
        
        <!-- Stock Market Section -->
        <section class="stocks-section">
            <div class="stocks-header">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 3v16a2 2 0 0 0 2 2h16"></path>
                        <path d="M7 14l4-4 4 4 6-6"></path>
                        <path d="M18 8h3v3"></path>
                    </svg>
                    Stock Market Data
                </h2>
                <div class="stock-controls">
                    <select id="stock-select" class="stock-select">
                        <option value="AAPL">Apple (AAPL)</option>
                        <option value="MSFT">Microsoft (MSFT)</option>
                        <option value="GOOGL">Google (GOOGL)</option>
                        <option value="AMZN">Amazon (AMZN)</option>
                        <option value="TSLA">Tesla (TSLA)</option>
                        <option value="SPY">S&P 500 (SPY)</option>
                    </select>
                    <select id="timeframe-select" class="timeframe-select">
                        <option value="TIME_SERIES_DAILY">Daily</option>
                        <option value="TIME_SERIES_WEEKLY">Weekly</option>
                        <option value="TIME_SERIES_MONTHLY">Monthly</option>
                    </select>
                    <button class="refresh-btn" id="refresh-stocks">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 0 1 9-9"></path>
                        </svg>
                        Refresh
                    </button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="stock-chart"></canvas>
            </div>
            <div class="stock-info" id="stock-info">
                <div class="stock-price" id="stock-price">Loading...</div>
                <div class="stock-change" id="stock-change">
                    <span id="change-amount">--</span>
                    <span id="change-percent">(--)</span>
                </div>
            </div>
        </section>
        
        <!-- Currency Exchange Section -->
        <section class="currency-section">
            <div class="currency-header">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="8"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                    Currency Exchange Rates
                </h2>
                <button class="refresh-btn" id="refresh-currency">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 0 1 9-9"></path>
                    </svg>
                    Refresh
                </button>
            </div>
            <div class="currency-grid" id="currency-container">
                <div class="loading">Loading currency data...</div>
            </div>
        </section>
       
        <!-- Map and Clocks Section -->
        <section class="map-clocks-section">
            <div class="map-container" id="satellite-map"></div>
            
            <div class="clocks-container">
                <div class="clock-card">
                    <div class="clock-flag">ðŸ‡ºðŸ‡¸</div>
                    <div class="clock-city">New York</div>
                    <div class="clock-time" id="time-ny">--:--:--</div>
                    <div class="clock-date" id="date-ny">--</div>
                </div>
                
                <div class="clock-card">
                    <div class="clock-flag">ðŸ‡¹ðŸ‡·</div>
                    <div class="clock-city">Istanbul</div>
                    <div class="clock-time" id="time-istanbul">--:--:--</div>
                    <div class="clock-date" id="date-istanbul">--</div>
                </div>
                
                <div class="clock-card">
                    <div class="clock-flag">ðŸ‡¬ðŸ‡§</div>
                    <div class="clock-city">London</div>
                    <div class="clock-time" id="time-london">--:--:--</div>
                    <div class="clock-date" id="date-london">--</div>
                </div>
                
                <div class="clock-card">
                    <div class="clock-flag">ðŸ‡¯ðŸ‡µ</div>
                    <div class="clock-city">Tokyo</div>
                    <div class="clock-time" id="time-tokyo">--:--:--</div>
                    <div class="clock-date" id="date-tokyo">--</div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>Â© 2025 TILT â€“ The Initiative for Life and Thoughts</p>
        <p>Designed with 8.6 billion neurons and a dream</p>
    </footer>

    <script>
        // Dark/Light mode toggle
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('change', () => {
            document.body.classList.toggle('dark-mode');
            
            // Save preference to localStorage
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
        });

        // Check for saved theme preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            themeToggle.checked = true;
        }

        // Shrink header on scroll
        const header = document.getElementById('main-header');
        let lastScroll = 0;
        
        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;
            
            if (currentScroll > lastScroll && currentScroll > 100) {
                // Scroll down
                header.classList.add('shrink');
            } else if (currentScroll < lastScroll || currentScroll <= 100) {
                // Scroll up or at top
                header.classList.remove('shrink');
            }
            
            lastScroll = currentScroll;
        });

        // Calendar functionality
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();

        const months = ["January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"];

        // Event data structure
        const events = [
            {
                id: 1,
                title: "TILT Annual Conference 2025",
                date: new Date(2025, 8, 8), // September 8th, 2025 (months are 0-indexed)
                description: "Join us for our annual conference exploring the future of human thought and technological advancement. Keynote speakers and workshops included.",
                color: "#dc3545"
            },
            {
                id: 2,
                title: "Philosophy Discussion Group",
                date: new Date(currentYear, currentMonth, 15),
                description: "Monthly meeting to discuss philosophical texts and ideas",
                color: "#28a745"
            },
            {
                id: 3,
                title: "Science & Society Workshop",
                date: new Date(currentYear, currentMonth, 22),
                description: "How scientific advancements are shaping our future society",
                color: "#007bff"
            }
        ];

        function generateCalendar(month, year) {
            const calendarBody = document.getElementById("calendar-body");
            const monthYearElement = document.getElementById("calendar-month-year");
            
            // Clear previous calendar
            calendarBody.innerHTML = "";
            
            // Set month and year header
            monthYearElement.textContent = `${months[month]} ${year}`;
            
            // Get first day of month and number of days in month
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Create date object for today to compare
            const today = new Date();
            const isCurrentMonth = month === today.getMonth() && year === today.getFullYear();
            
            // Create calendar
            let date = 1;
            for (let i = 0; i < 6; i++) {
                // Create a table row
                const row = document.createElement("tr");
                
                // Create individual cells for each day
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < firstDay) {
                        // Empty cells before the first day of the month
                        const cell = document.createElement("td");
                        const cellText = document.createTextNode("");
                        cell.appendChild(cellText);
                        row.appendChild(cell);
                    } else if (date > daysInMonth) {
                        // Empty cells after the last day of the month
                        const cell = document.createElement("td");
                        const cellText = document.createTextNode("");
                        cell.appendChild(cellText);
                        row.appendChild(cell);
                    } else {
                        // Cells with dates
                        const cell = document.createElement("td");
                        
                        // Check if this is the current day
                        if (isCurrentMonth && date === today.getDate()) {
                            const dayDiv = document.createElement("div");
                            dayDiv.className = "current-day";
                            dayDiv.textContent = date;
                            cell.appendChild(dayDiv);
                        } else {
                            const cellText = document.createTextNode(date);
                            cell.appendChild(cellText);
                        }
                        
                        // Check if this date is from a different month (for next/prev month days)
                        if ((i === 0 && j < firstDay) || date > daysInMonth) {
                            cell.classList.add("other-month");
                        }
                        
                        // Check if this date has any events
                        const hasEvent = events.some(event => {
                            const eventDate = event.date;
                            return eventDate.getDate() === date && 
                                   eventDate.getMonth() === month && 
                                   eventDate.getFullYear() === year;
                        });
                        
                        if (hasEvent) {
                            cell.classList.add("event-day");
                            const indicator = document.createElement("div");
                            indicator.className = "event-indicator";
                            indicator.title = "Click to view events";
                            cell.appendChild(indicator);
                            
                            // Add click event to show events
                            cell.addEventListener('click', () => {
                                showEventsForDate(date, month, year);
                            });
                        }
                        
                        row.appendChild(cell);
                        date++;
                    }
                }
                
                // Append the row to the calendar body
                calendarBody.appendChild(row);
                
                // Stop making rows if we've run out of days
                if (date > daysInMonth) {
                    break;
                }
            }
        }

        // Function to show events for a specific date
        function showEventsForDate(day, month, year) {
            const selectedDate = new Date(year, month, day);
            
            // Find events for this date
            const eventsForDate = events.filter(event => {
                const eventDate = event.date;
                return eventDate.getDate() === day && 
                       eventDate.getMonth() === month && 
                       eventDate.getFullYear() === year;
            });
            
            if (eventsForDate.length > 0) {
                showEventModal(eventsForDate, selectedDate);
            }
        }

        // Function to show event modal
        function showEventModal(events, date) {
            // Create or show modal
            let modal = document.getElementById('event-modal');
            let overlay = document.getElementById('modal-overlay');
            
            if (!modal) {
                // Create modal
                modal = document.createElement('div');
                modal.id = 'event-modal';
                modal.className = 'event-modal';
                
                // Create overlay
                overlay = document.createElement('div');
                overlay.id = 'modal-overlay';
                overlay.className = 'overlay';
                overlay.addEventListener('click', closeEventModal);
                
                document.body.appendChild(modal);
                document.body.appendChild(overlay);
            }
            
            // Build modal content
            let modalContent = `
                <button class="close-btn">&times;</button>
                <h3>Events on ${date.toDateString()}</h3>
            `;
            
            events.forEach(event => {
                modalContent += `
                    <div class="event-item" style="border-left: 4px solid ${event.color}; padding-left: 10px; margin-bottom: 15px;">
                        <h4 style="margin-top: 0; color: ${event.color};">${event.title}</h4>
                        <p class="event-description">${event.description}</p>
                    </div>
                `;
            });
            
            modal.innerHTML = modalContent;
            
            // Add close event to button
            modal.querySelector('.close-btn').addEventListener('click', closeEventModal);
            
            // Show modal and overlay
            modal.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Function to close event modal
        function closeEventModal() {
            const modal = document.getElementById('event-modal');
            const overlay = document.getElementById('modal-overlay');
            
            if (modal) modal.style.display = 'none';
            if (overlay) overlay.style.display = 'none';
        }

        // Navigation functions
        document.getElementById("prev-month").addEventListener("click", () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendar(currentMonth, currentYear);
        });

        document.getElementById("next-month").addEventListener("click", () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendar(currentMonth, currentYear);
        });

        document.getElementById("today").addEventListener("click", () => {
            currentDate = new Date();
            currentMonth = currentDate.getMonth();
            currentYear = currentDate.getFullYear();
            generateCalendar(currentMonth, currentYear);
        });

        // Initialize calendar
        generateCalendar(currentMonth, currentYear);

        // NYT News API Integration
        const newsContainer = document.getElementById('news-container');
        const refreshButton = document.getElementById('refresh-news');
        
        // NYT API Key
        const API_KEY = '6NNf0KIZZZElhq4ZSOTfYqInqbB84dRN';
        
        // Function to fetch news from NYT
        async function fetchNews() {
            try {
                newsContainer.innerHTML = '<div class="loading">Loading news...</div>';
                
                // Fetch news from NYT API
                const response = await fetch(`https://api.nytimes.com/svc/topstories/v2/home.json?api-key=${API_KEY}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.results && data.results.length > 0) {
                    displayNews(data.results);
                } else {
                    throw new Error('No news articles found in response');
                }
                
            } catch (error) {
                console.error('Error fetching news:', error);
                
                // Fallback to mock data if API fails
                const mockNews = [
                    {
                        title: 'Climate Change Agreement Reached at International Summit',
                        abstract: 'World leaders have agreed on a new set of measures to combat climate change, aiming for carbon neutrality by 2050.',
                        url: 'https://www.nytimes.com/',
                        byline: 'By JANE DOE',
                        published_date: '2023-09-15',
                        multimedia: [
                            {
                                url: 'https://via.placeholder.com/300x160?text=Climate+News',
                                format: 'Standard Thumbnail'
                            }
                        ]
                    },
                    {
                        title: 'New Breakthrough in Quantum Computing',
                        abstract: 'Scientists announce a major advancement in quantum computing that could revolutionize technology industries.',
                        url: 'https://www.nytimes.com/',
                        byline: 'By JOHN SMITH',
                        published_date: '2023-09-14',
                        multimedia: [
                            {
                                url: 'https://via.placeholder.com/300x160?text=Quantum+Computing',
                                format: 'Standard Thumbnail'
                            }
                        ]
                    },
                    {
                        title: 'Global Economic Forum Addresses Rising Inflation',
                        abstract: 'Economists and policymakers gather to discuss strategies for managing inflation and supporting economic growth.',
                        url: 'https://www.nytimes.com/',
                        byline: 'By ALICE JOHNSON',
                        published_date: '2023-09-13',
                        multimedia: [
                            {
                                url: 'https://via.placeholder.com/300x160?text=Economy',
                                format: 'Standard Thumbnail'
                            }
                        ]
                    },
                    {
                        title: 'Space Exploration Reaches New Milestone',
                        abstract: 'The latest space mission has successfully reached its destination, marking a new era in interstellar exploration.',
                        url: 'https://www.nytimes.com/',
                        byline: 'By ROBERT WILLIAMS',
                        published_date: '2023-09-12',
                        multimedia: [
                            {
                                url: 'https://via.placeholder.com/300x160?text=Space',
                                format: 'Standard Thumbnail'
                            }
                        ]
                    }
                ];
                
                displayNews(mockNews);
                
                // Show error message but still display mock data
                newsContainer.innerHTML = `
                    <div class="error">
                        <p>NYT API connection failed. Showing sample news.</p>
                        <p><small>${error.message}</small></p>
                    </div>
                ` + newsContainer.innerHTML;
            }
        }
        
        // Function to display news articles
        function displayNews(articles) {
            if (!articles || articles.length === 0) {
                newsContainer.innerHTML = '<div class="error">No news articles found.</div>';
                return;
            }
            
            // Limit to 4 articles for better layout
            const articlesToShow = articles.slice(0, 4);
            
            newsContainer.innerHTML = articlesToShow.map(article => {
                // Find a suitable image
                let imageUrl = 'https://via.placeholder.com/300x160?text=News';
                if (article.multimedia && article.multimedia.length > 0) {
                    // Try to find a large image first
                    const largeImage = article.multimedia.find(media => media.format === 'superJumbo');
                    const normalImage = article.multimedia.find(media => media.format === 'Normal');
                    const thumbImage = article.multimedia.find(media => media.format === 'Standard Thumbnail');
                    
                    if (largeImage) imageUrl = largeImage.url;
                    else if (normalImage) imageUrl = normalImage.url;
                    else if (thumbImage) imageUrl = thumbImage.url;
                    else imageUrl = article.multimedia[0].url;
                }
                
                return `
                    <div class="news-card">
                        <img src="${imageUrl}" alt="${article.title}" class="news-image">
                        <div class="news-content">
                            <h3 class="news-title">
                                <a href="${article.url}" target="_blank" rel="noopener">${article.title}</a>
                            </h3>
                            <p class="news-description">${article.abstract}</p>
                            <div class="news-meta">
                                <span>${article.byline || 'By New York Times'}</span>
                                <span>${new Date(article.published_date).toLocaleDateString()}</span>
                            </div>
                            </div>
                    </div>
                `;
            }).join('');
        }
        
        // Event listener for refresh button
        refreshButton.addEventListener('click', fetchNews);
        
        // Fetch news on page load
        fetchNews();
        
        // Stock Market Data Section
        const stockSelect = document.getElementById('stock-select');
        const timeframeSelect = document.getElementById('timeframe-select');
        const refreshStocksButton = document.getElementById('refresh-stocks');
        const stockChartCanvas = document.getElementById('stock-chart');
        const stockPriceElement = document.getElementById('stock-price');
        const changeAmountElement = document.getElementById('change-amount');
        const changePercentElement = document.getElementById('change-percent');
        const stockInfoElement = document.getElementById('stock-info');
        
        let stockChart = null;
        
        // Function to fetch stock data
        async function fetchStockData(symbol = 'AAPL', timeframe = 'TIME_SERIES_DAILY') {
            try {
                stockInfoElement.innerHTML = '<div class="loading">Loading stock data...</div>';
                
                // Use mock data instead of API to avoid errors
                const mockData = generateMockStockData(symbol, timeframe);
                displayStockData(mockData);
                
            } catch (error) {
                console.error('Error fetching stock data:', error);
                
                // Fallback to mock data if API fails
                const mockData = generateMockStockData(symbol, timeframe);
                displayStockData(mockData);
                
                // Show error message but still display data
                stockInfoElement.innerHTML = `
                    <div class="error">
                        <p>Stock API connection issue. Showing sample data.</p>
                        <p><small>${error.message}</small></p>
                    </div>
                ` + stockInfoElement.innerHTML;
            }
        }
        
        // Function to generate mock stock data (fallback)
        function generateMockStockData(symbol, timeframe) {
            const data = { 
                symbol: symbol,
                values: [],
                currentPrice: 0,
                previousPrice: 0
            };
            
            // Set base price based on symbol
            const basePrices = {
                'AAPL': 170, 'MSFT': 330, 'GOOGL': 135, 
                'AMZN': 140, 'TSLA': 240, 'SPY': 450
            };
            
            const basePrice = basePrices[symbol] || 100;
            const volatility = basePrice * 0.02; // 2% volatility
            
            // Generate data points
            const points = timeframe === 'TIME_SERIES_MONTHLY' ? 30 : 
                          timeframe === 'TIME_SERIES_WEEKLY' ? 60 : 90;
            
            let currentValue = basePrice;
            const values = [];
            
            for (let i = points; i >= 0; i--) {
                // Random walk for stock price
                const change = (Math.random() - 0.5) * volatility;
                currentValue += change;
                
                // Ensure price doesn't go negative
                currentValue = Math.max(5, currentValue);
                
                // Format date
                const date = new Date();
                date.setDate(date.getDate() - i);
                
                values.push({
                    date: date.toISOString().split('T')[0],
                    price: parseFloat(currentValue.toFixed(2))
                });
            }
            
            data.values = values;
            data.currentPrice = values[values.length - 1].price;
            data.previousPrice = values[values.length - 2].price;
            
            return data;
        }
        
        // Function to display stock data in chart
        function displayStockData(stockData) {
            const dates = stockData.values.map(item => {
                const date = new Date(item.date);
                return date.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric' 
                });
            });
            
            const prices = stockData.values.map(item => item.price);
            
            // Calculate price change
            const change = stockData.currentPrice - stockData.previousPrice;
            const changePercent = (change / stockData.previousPrice) * 100;
            
            // Update price display
            stockPriceElement.textContent = `$${stockData.currentPrice.toFixed(2)}`;
            changeAmountElement.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}`;
            changePercentElement.textContent = `(${change >= 0 ? '+' : ''}${changePercent.toFixed(2)}%)`;
            
            // Set color based on change
            if (change > 0) {
                changeAmountElement.className = 'positive';
                changePercentElement.className = 'positive';
                stockPriceElement.className = 'stock-price positive';
            } else if (change < 0) {
                changeAmountElement.className = 'negative';
                changePercentElement.className = 'negative';
                stockPriceElement.className = 'stock-price negative';
            } else {
                changeAmountElement.className = '';
                changePercentElement.className = '';
                stockPriceElement.className = 'stock-price';
            }
            
            // Create or update chart
            const ctx = stockChartCanvas.getContext('2d');
            
            if (stockChart) {
                stockChart.destroy();
            }
            
            stockChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: `${stockData.symbol} Price`,
                        data: prices,
                        borderColor: change >= 0 ? '#28a745' : '#dc3545',
                        backgroundColor: change >= 0 ? 'rgba(40, 167, 69, 0.1)' : 'rgba(220, 53, 69, 0.1)',
                        fill: true,
                        tension: 0.1,
                        pointRadius: 0,
                        pointHoverRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `$${context.raw.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Event listeners for stock controls
        stockSelect.addEventListener('change', () => {
            fetchStockData(stockSelect.value, timeframeSelect.value);
        });
        
        timeframeSelect.addEventListener('change', () => {
            fetchStockData(stockSelect.value, timeframeSelect.value);
        });
        
        refreshStocksButton.addEventListener('click', () => {
            fetchStockData(stockSelect.value, timeframeSelect.value);
        });
        
        // Initialize stock data
        fetchStockData();
          
      // Currency Exchange Rates Section
    const currencyContainer = document.getElementById('currency-container');
    const refreshCurrencyButton = document.getElementById('refresh-currency');
    const EXCHANGE_RATE_API_KEY = '5cae913d674df6bdbd3b6951';
    
    // Store previous rates to calculate changes
    let previousRates = {};
    
    // Function to fetch currency data
    async function fetchCurrencyData() {
        try {
            currencyContainer.innerHTML = '<div class="loading">Loading currency data...</div>';
            
            // Fetch data from ExchangeRate-API
            const response = await fetch(`https://v6.exchangerate-api.com/v6/${EXCHANGE_RATE_API_KEY}/latest/USD`);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            
            if (data && data.conversion_rates) {
                const rates = data.conversion_rates;
                const currentTime = new Date().toISOString();
                
                // Calculate changes if we have previous data
                let changes = {};
                if (Object.keys(previousRates).length > 0) {
                    changes = calculateChanges(previousRates, rates);
                }
                
                // Store current rates for next comparison
                previousRates = {...rates};
                
                // Prepare currency data
                const currencyData = [
                    {
                        pair: "USD/EUR",
                        rate: rates.EUR || 0,
                        change: changes.EUR || 0,
                        changePercent: changes.EUR ? (changes.EUR / (rates.EUR - changes.EUR)) * 100 : 0,
                        lastUpdated: currentTime
                    },
                    {
                        pair: "USD/TRY",
                        rate: rates.TRY || 0,
                        change: changes.TRY || 0,
                        changePercent: changes.TRY ? (changes.TRY / (rates.TRY - changes.TRY)) * 100 : 0,
                        lastUpdated: currentTime
                    },
                    {
                        pair: "EUR/TRY",
                        rate: rates.TRY && rates.EUR ? rates.TRY / rates.EUR : 0,
                        change: changes.EUR_TRY || 0,
                        changePercent: changes.EUR_TRY ? (changes.EUR_TRY / ((rates.TRY / rates.EUR) - changes.EUR_TRY)) * 100 : 0,
                        lastUpdated: currentTime
                    },
                    {
                        pair: "USD/GBP",
                        rate: rates.GBP || 0,
                        change: changes.GBP || 0,
                        changePercent: changes.GBP ? (changes.GBP / (rates.GBP - changes.GBP)) * 100 : 0,
                        lastUpdated: currentTime
                    }
                ];
                
                displayCurrencyData(currencyData);
            } else {
                throw new Error('No currency data found in response');
            }
            
        } catch (error) {
            console.error('Error fetching currency data:', error);
            
            // Fallback to mock data if API fails
            const mockCurrencyData = [
                {
                    pair: "USD/EUR",
                    rate: 0.93,
                    change: 0.002,
                    changePercent: 0.22,
                    lastUpdated: new Date().toISOString()
                },
                {
                    pair: "USD/TRY",
                    rate: 32.15,
                    change: -0.25,
                    changePercent: -0.77,
                    lastUpdated: new Date().toISOString()
                },
                {
                    pair: "EUR/TRY",
                    rate: 34.58,
                    change: 0.12,
                    changePercent: 0.35,
                    lastUpdated: new Date().toISOString()
                },
                {
                    pair: "USD/GBP",
                    rate: 0.79,
                    change: 0.005,
                    changePercent: 0.64,
                    lastUpdated: new Date().toISOString()
                }
            ];
            
            displayCurrencyData(mockCurrencyData);
            
            // Show error message but still display data
            currencyContainer.innerHTML = `
                <div class="error">
                    <p>Currency API connection issue. Showing sample data.</p>
                    <p><small>${error.message}</small></p>
                </div>
            ` + currencyContainer.innerHTML;
        }
    }
    
    // Function to calculate changes between previous and current rates
    function calculateChanges(prevRates, currentRates) {
        const changes = {};
        
        // Calculate direct rate changes
        if (prevRates.EUR && currentRates.EUR) {
            changes.EUR = currentRates.EUR - prevRates.EUR;
        }
        if (prevRates.TRY && currentRates.TRY) {
            changes.TRY = currentRates.TRY - prevRates.TRY;
        }
        if (prevRates.GBP && currentRates.GBP) {
            changes.GBP = currentRates.GBP - prevRates.GBP;
        }
        
        // Calculate cross rate changes (EUR/TRY)
        if (prevRates.EUR && prevRates.TRY && currentRates.EUR && currentRates.TRY) {
            const prevEurTry = prevRates.TRY / prevRates.EUR;
            const currentEurTry = currentRates.TRY / currentRates.EUR;
            changes.EUR_TRY = currentEurTry - prevEurTry;
        }
        
        return changes;
    }
    
    // Function to display currency data
    function displayCurrencyData(currencies) {
        if (!currencies || currencies.length === 0) {
            currencyContainer.innerHTML = '<div class="error">No currency data found.</div>';
            return;
        }
        
        currencyContainer.innerHTML = currencies.map(currency => {
            const isPositive = currency.change >= 0;
            const changeIcon = isPositive ? 'â†—' : 'â†˜';
            
            return `
                <div class="currency-card">
                    <div class="currency-pair">
                        <span>${currency.pair}</span>
                        <span class="currency-flag">${getFlagEmoji(currency.pair)}</span>
                    </div>
                    <div class="currency-rate">${currency.rate.toFixed(4)}</div>
                    <div class="currency-change ${isPositive ? 'positive' : 'negative'}">
                        <span>${changeIcon} ${isPositive ? '+' : ''}${currency.change.toFixed(4)}</span>
                        <span>(${isPositive ? '+' : ''}${currency.changePercent.toFixed(2)}%)</span>
                    </div>
                    <div class="currency-info">
                        <span>Last updated:</span>
                        <span>${new Date(currency.lastUpdated).toLocaleTimeString()}</span>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    // Helper function to get flag emojis for currency pairs
    function getFlagEmoji(pair) {
        const flagMap = {
            'USD': 'ðŸ‡ºðŸ‡¸',
            'EUR': 'ðŸ‡ªðŸ‡º',
            'TRY': 'ðŸ‡¹ðŸ‡·',
            'GBP': 'ðŸ‡¬ðŸ‡§'
        };
        
        const [from, to] = pair.split('/');
        return `${flagMap[from] || 'ðŸ’µ'} â†’ ${flagMap[to] || 'ðŸ’µ'}`;
    }
    
    // Event listener for refresh button
    refreshCurrencyButton.addEventListener('click', fetchCurrencyData);
    
    // Fetch currency data on page load
    fetchCurrencyData();
    
    // Refresh currency data every 5 minutes
    setInterval(fetchCurrencyData, 5 * 60 * 1000);
        
        // Initialize satellite map with better tile source
        function initMap() {
            // Create map centered on the world
            const map = L.map('satellite-map').setView([20, 0], 2);
            
            // Add better satellite tile layer
            const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
                maxZoom: 18
            });
            
            // Add a fallback standard map layer
            const standardLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
            });
            
            // Add layer control
            const baseMaps = {
                "Satellite": satelliteLayer,
                "Standard": standardLayer
            };
            
            // Add the satellite layer by default
            satelliteLayer.addTo(map);
            L.control.layers(baseMaps).addTo(map);
            
            // Add some markers for the cities we're showing clocks for
            const cities = [
                {name: "New York", coords: [40.7128, -74.0060]},
                {name: "Istanbul", coords: [41.0082, 28.9784]},
                {name: "London", coords: [51.5074, -0.1278]},
                {name: "Tokyo", coords: [35.6762, 139.6503]}
            ];
            
            cities.forEach(city => {
                L.marker(city.coords)
                    .addTo(map)
                    .bindPopup(city.name);
            });
        }

        // Update world clocks
        function updateClocks() {
            const timeOptions = { 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false 
            };
            
            const dateOptions = { 
                weekday: 'short', 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            };
            
            // New York (EST/EDT)
            const nyTime = new Date().toLocaleString('en-US', { 
                timeZone: 'America/New_York',
                ...timeOptions
            });
            const nyDate = new Date().toLocaleString('en-US', { 
                timeZone: 'America/New_York',
                ...dateOptions
            });
            document.getElementById('time-ny').textContent = nyTime;
            document.getElementById('date-ny').textContent = nyDate;
            
            // Istanbul
            const istanbulTime = new Date().toLocaleString('en-US', { 
                timeZone: 'Europe/Istanbul',
                ...timeOptions
            });
            const istanbulDate = new Date().toLocaleString('en-US', { 
                timeZone: 'Europe/Istanbul',
                ...dateOptions
            });
            document.getElementById('time-istanbul').textContent = istanbulTime;
            document.getElementById('date-istanbul').textContent = istanbulDate;
            
            // London
            const londonTime = new Date().toLocaleString('en-US', { 
                timeZone: 'Europe/London',
                ...timeOptions
            });
            const londonDate = new Date().toLocaleString('en-US', { 
                timeZone: 'Europe/London',
                ...dateOptions
            });
            document.getElementById('time-london').textContent = londonTime;
            document.getElementById('date-london').textContent = londonDate;
            
            // Tokyo
            const tokyoTime = new Date().toLocaleString('en-US', { 
                timeZone: 'Asia/Tokyo',
                ...timeOptions
            });
            const tokyoDate = new Date().toLocaleString('en-US', { 
                timeZone: 'Asia/Tokyo',
                ...dateOptions
            });
            document.getElementById('time-tokyo').textContent = tokyoTime;
            document.getElementById('date-tokyo').textContent = tokyoDate;
        }

        // Initialize map and clocks when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            updateClocks();
            
            // Update clocks every second
            setInterval(updateClocks, 1000);
        });
    </script>
</body>
</html>
